{"version":3,"file":"validate.js","sources":["../util.js","../validate.js"],"sourcesContent":["/**\n * Read a property, attribute or data-attribute of an element\n *\n * @param {JQuery<HTMLElement>} $elem\n * @param {String} prop\n *\n * @return {any}\n */\nexport function read_pratr($elem, prop) {\n    let ret = $elem.prop(prop);\n    if (ret === \"\" || ret == null || typeof ret == \"object\")\n        ret = $elem.attr(prop);\n    if (ret === \"\" || ret == null)\n        ret = $elem.data(prop);\n    return ret;\n}\n/**\n * Get element's name from either attribute or data-attribute\n *\n * @param  {JQuery<HTMLElement>} $elem\n *\n * @return {String}\n */\nexport function getName($elem) {\n    return $elem.attr(\"name\") || $elem.data(\"name\");\n}\n// ---------------------------------------------------------------------------\nconst _eq_r_ = /[\\\\'\"]/g; // Escape for use inside quotes \" | '\nconst _is_url_r_ = /^[a-z]{3,7}\\:\\/\\/[a-z0-9]/i;\nconst _is_domain_r_ = /^[a-z0-9][0-9a-z_\\-]*(?:\\.[a-z0-9][0-9a-z_\\-]*)*$/;\nconst _is_email_r_ = /^((([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+(\\.([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+)*)|((\\x22)((((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(([\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f]|\\x21|[\\x23-\\x5b]|[\\x5d-\\x7e]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(\\\\([\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]))))*(((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(\\x22)))@((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))$/i;\n// - String validation functions -\nexport function esc_quot(str) {\n    return String(str).replace(_eq_r_, \"\\\\$&\");\n}\nexport function is_domain(str) {\n    return _is_domain_r_.test(str);\n}\nexport function is_url(str) {\n    return _is_url_r_.test(str);\n}\nexport function is_email(str) {\n    return _is_email_r_.test(str);\n}\n// ---------------------------------------------------------------------------\n/**\n * 4-10 times faster .each replacement\n * use it carefully, as it overrides jQuery context of element on each iteration\n *\n * function clb.call(DOM, idx, $DOM, DOM) {};\n *    $DOM == $(DOM), is the same object throughout iteration\n *\n */\nexport function $each($list, iterator) {\n    const l = $list.length;\n    const j = l > 1 ? $list.constructor([0]) : $list;\n    let i = -1, d;\n    while (++i < l &&\n        (j[0] = d = $list[i]) &&\n        (!i || (j.context = d)) && // .context is deprecated in jQuery v1.10\n        // clb.call(\"this\"=DOM, i=index, j=jQuery object, d=DOM)\n        iterator.call(d, i, j, d) !== false)\n        ;\n    return $list;\n}\n// ---------------------------------------------------------------------------\nexport const isEventSupported = (function (_doc) {\n    const TAGNAMES = {\n        select: \"input\",\n        change: \"input\",\n        submit: \"form\",\n        reset: \"form\",\n        error: \"img\",\n        load: \"img\",\n        abort: \"img\",\n    };\n    function isEventSupported(eventName, document = _doc) {\n        let el = document.createElement(TAGNAMES[eventName] || \"div\");\n        eventName = \"on\" + eventName;\n        let isSupported = eventName in el;\n        if (!isSupported) {\n            el.setAttribute(eventName, \"return;\");\n            isSupported = typeof el[eventName] == \"function\";\n        }\n        el = null;\n        return isSupported;\n    }\n    return isEventSupported;\n})(window.document);\n// ---------------------------------------------------------------------------\n","/**\n * Form validation plugin.\n *\n * @author Dumitru Uzun (https://DUzun.Me)\n * @version 1.3.0\n */\nimport { esc_quot, is_domain, is_email, is_url, getName, read_pratr, $each, } from \"./util\";\n/*globals Promise*/\nconst STRING = \"string\";\nconst NUMBER = \"number\";\nconst FUNCTION = \"function\";\nconst VALID = \"valid\";\nconst INVALID = \"invalid\";\nconst NS = \".vldtr\";\nexport default function jquery_validate($) {\n    // ---------------------------------------------------------------------------\n    $.fn.validator = fnValidator;\n    $.fn.validate = fnValidate;\n    $.validate = validate;\n    // ---------------------------------------------------------------------------\n    fnValidator.handler = handler;\n    validate.readRules = readRules;\n    validate.msg = msg;\n    // ---------------------------------------------------------------------------\n    validate.defaults = {\n        valid: undefined,\n        hintElement: undefined,\n        fieldGroup: undefined,\n        validClass: VALID,\n        invalidClass: INVALID,\n        rules: {},\n        messages: {\n            // Default messages\n            //      _: { fieldName: 'message' }\n            _: {\n                email: \"Email is not correct\",\n                url: \"Not a valid URL\",\n                number: \"Not a valid number\",\n                required: \"%f% is required\",\n                equalto: `Fields don't match`,\n                minlength: \"%f% must be %r% characters or more\",\n                maxlength: \"%f% must be no more then %r% characters\",\n            },\n            // Field specific messages\n            //      fieldName: { ruleName: 'message' }\n            password: {\n                required: \"Password is required\",\n                equalto: `Passwords don't match`,\n            },\n            password2: {\n                equalto: `Passwords don't match`,\n            },\n        },\n    };\n    // ---------------------------------------------------------------------------\n    $.extend(validate, {\n        // Expose validation functions:\n        is_domain,\n        is_url,\n        is_email,\n        getName,\n    });\n    // ---------------------------------------------------------------------------\n    function fnValidator(options, _rules, _silent) {\n        const self = this;\n        const on = [\n            \"keyup\",\n            \"input\",\n            \"blur\",\n            \"focusout\",\n            \"change\",\n            \"paste\",\n            \"cut\",\n            \"validate\",\n        ], ev = on.join(NS + \" \") + NS;\n        if (typeof options == STRING) {\n            switch (options) {\n                case \"validate\":\n                    return $.fn.validate.call(self, _rules, _silent);\n                case \"refresh\":\n                    return _form_refresh.call(self);\n                case \"off\":\n                    return self.off(ev, $.fn.validator.handler);\n                case \"on\":\n                    return self.on(ev, $.fn.validator.handler);\n            }\n        }\n        options = _prepOptions(options);\n        $each(self, function (i, $form) {\n            const validatorOpt = $.extend(true, { _invalids: {} /*, _origs:{}*/ }, options, $form.data(\"validatorOpt\") || {});\n            $form\n                .on(\"dom:update\", _form_refresh) // when DOM is manipulated, refresh form\n                .on(ev, $.fn.validator.handler)\n                .data(\"validatorOpt\", validatorOpt);\n        })\n            .attr(\"novalidate\", \"novalidate\");\n        _form_refresh.call(self, undefined, true);\n        return self;\n    }\n    function handler(evt) {\n        const self = this, $this = $(this), target = (evt && evt.target) || self, $target = $(target), name = getName($target), toName = \"_to_\" + name;\n        let validatorOpt = $this.data(\"validatorOpt\"), delay = 17, to;\n        if (!name || !$target.is(\":input\"))\n            return;\n        if (validatorOpt) {\n            to = validatorOpt[toName];\n        }\n        else {\n            $this.data(\"validatorOpt\", (validatorOpt = {}));\n        }\n        let type = evt && evt.type;\n        if (type)\n            switch (type) {\n                case \"input\": // invoked at keydown (if supported) or any other kind of input\n                case \"keyup\":\n                    delay = 250; // typing\n                    break;\n                case \"validate\":\n                case \"focusout\":\n                case \"blur\":\n                    delay = 0; // done from this input\n                    break;\n            }\n        // Debounce validation\n        if (to)\n            clearTimeout(to);\n        validatorOpt[toName] = to = setTimeout(function () {\n            let rule = validatorOpt.rules;\n            if (rule)\n                rule = rule[name];\n            $.validate(target, rule, (valid, ret) => {\n                _on_validate(target, valid, ret, rule, {\n                    $tgt: $target,\n                    $ctx: $this,\n                    opt: validatorOpt,\n                    evt,\n                    name,\n                });\n            }, $this);\n            delete validatorOpt[toName];\n        }, delay);\n    }\n    // ---------------------------------------------------------------------------\n    /**\n     *  Validate an element.\n     *\n     *  @param (callback) clb.call($elem, (bool)valid, (str)rulename, value, (obj)rules)\n     */\n    function validate(element, rules, clb, ctx, options) {\n        const $elem = $(element);\n        const valResAttr = \"validatorRes\";\n        let oldVal = $elem.val(), val = oldVal, t, ruleName, cause = $elem.data(INVALID), _state_ = {\n        // rules: rules,\n        // value: val,\n        // valid: true,\n        }, _res = function (valid) {\n            $elem.data(valResAttr, _state_).prop(VALID, valid);\n            if (typeof clb == FUNCTION) {\n                clb.call($elem, valid, _state_);\n            }\n            if ((t = _state_._clbstk_)) {\n                delete _state_._clbstk_;\n                $.each(t, (i, fn) => {\n                    fn.call($elem, valid, _state_);\n                });\n            }\n            return valid;\n        }, _invalidate = function (rule, x) {\n            _state_.rule = rule; // deprecated\n            _state_[INVALID] = rule;\n            _state_[VALID] = false;\n            if (x)\n                _state_.remote = x;\n            $elem.data(INVALID, rule).removeClass(VALID);\n            return _res(false);\n        }, _validate = function (x) {\n            _state_.rule = cause; // deprecated\n            delete _state_[INVALID];\n            _state_[VALID] = true;\n            if (x)\n                _state_.remote = x;\n            $elem.data(INVALID, null).removeClass(INVALID);\n            return _res(true);\n        }, last_ret;\n        if (!rules) {\n            rules = $.validate.readRules($elem);\n            // Ignore last_res for custom rules\n            last_ret = $elem.data(valResAttr);\n        }\n        if (last_ret && !rules[\"equalto\"] && !rules[\"dynamic\"]) {\n            if (last_ret.value === val) {\n                _state_ = last_ret;\n                if (_state_._validating_ &&\n                    $.now() - _state_._validating_ < 3e3) {\n                    if (typeof clb == FUNCTION) {\n                        t = _state_._clbstk_ || (_state_._clbstk_ = []);\n                        t[t.length] = clb;\n                    }\n                }\n                else {\n                    if (_state_[VALID]) {\n                        _validate();\n                    }\n                    else {\n                        _invalidate(_state_[INVALID]);\n                    }\n                }\n                return _state_.valid;\n            }\n        }\n        if (rules[(ruleName = \"trim\")]) {\n            if (typeof val == STRING) {\n                val = $.trim(val);\n            }\n            else if (Array.isArray(val)) {\n                val = val.map($.trim);\n            }\n        }\n        _state_.rules = rules;\n        _state_.value = val;\n        if (rules[(ruleName = \"required\")]) {\n            if (val === \"\") {\n                return _invalidate(ruleName);\n            }\n        }\n        ruleName = \"minlength\";\n        if (ruleName in rules) {\n            if (val !== \"\" && String(val).length < rules[ruleName]) {\n                return _invalidate(ruleName);\n            }\n        }\n        ruleName = \"maxlength\";\n        if (ruleName in rules) {\n            if (-1 < rules[ruleName] && rules[ruleName] < String(val).length) {\n                return _invalidate(ruleName);\n            }\n        }\n        if (rules[(ruleName = \"equalto\")]) {\n            t = $elem.data(\"$\" + ruleName); // cache the elem\n            if (!t || !t.length) {\n                t = $elem.closest(\"form\");\n                if (!t.length)\n                    t = $(\"body\");\n                // element name\n                if (rules[ruleName].match(/^[a-z_]/)) {\n                    t = t.find('[name=\"' + esc_quot(rules[ruleName]) + '\"]');\n                }\n                // jQuery selector\n                else {\n                    t = t.find(rules[ruleName]);\n                }\n                $elem.data(\"$\" + ruleName, t);\n            }\n            if (!t.length || t.val() != val) {\n                return _invalidate(ruleName);\n            }\n        }\n        if (rules[(ruleName = \"noclass\")]) {\n            if ($elem.hasClass(rules[ruleName])) {\n                return _invalidate(ruleName);\n            }\n        }\n        if (rules[(ruleName = \"email\")]) {\n            if (val !== \"\" && !is_email(val)) {\n                return _invalidate(ruleName);\n            }\n        }\n        if (rules[(ruleName = \"url\")]) {\n            if (val !== \"\" && !is_url(val)) {\n                return _invalidate(ruleName);\n            }\n        }\n        if (rules[(ruleName = \"domain\")]) {\n            if (val !== \"\" && !is_domain(val)) {\n                return _invalidate(ruleName);\n            }\n        }\n        if (rules[(ruleName = NUMBER)]) {\n            if (val !== \"\") {\n                if (isNaN(+val)) {\n                    return _invalidate(ruleName);\n                }\n                else {\n                    _state_.value = val = parseFloat(val);\n                }\n            }\n        }\n        ruleName = \"maxval\";\n        if (ruleName in rules) {\n            if (val !== \"\") {\n                t = rules[ruleName];\n                if (typeof val == NUMBER)\n                    t = parseFloat(t);\n                if (t < val) {\n                    return _invalidate(ruleName);\n                }\n            }\n        }\n        ruleName = \"minval\";\n        if (ruleName in rules) {\n            if (val !== \"\") {\n                t = rules[ruleName];\n                if (typeof val == NUMBER)\n                    t = parseFloat(t);\n                if (val < t) {\n                    return _invalidate(ruleName);\n                }\n            }\n        }\n        const asyncs = [];\n        $.each(rules, (ruleName, fn) => {\n            if (fn && typeof fn == FUNCTION && ruleName != \"remote\") {\n                let t = fn.call(_state_, val, $elem, _state_);\n                if (false === t) {\n                    return _invalidate(ruleName);\n                }\n                if ($.type(t) == \"error\") {\n                    _state_.remote = t;\n                    return _invalidate(ruleName);\n                }\n                if (t && t.then) {\n                    t.rule = ruleName;\n                    asyncs.push(t);\n                }\n            }\n        });\n        if (VALID in _state_ && !_state_[VALID])\n            return false;\n        // Server-side validation\n        ruleName = \"remote\";\n        if (ruleName in rules) {\n            let form = ctx ? $(ctx) : $elem.closest(\"form\"), fieldName = getName($elem), data = { action: \"validate\", field: fieldName, value: val }, url = rules[ruleName];\n            ctx = form;\n            if (form.length) {\n                data.form = getName(form);\n            }\n            else {\n                form = null;\n            }\n            if (typeof url == FUNCTION) {\n                url = url.call($elem, data, _state_);\n                if (url === false) {\n                    return _invalidate(ruleName);\n                    return;\n                }\n                if ($.isPlainObject(url)) {\n                    data = url;\n                    url = data.url;\n                    delete data.url;\n                }\n            }\n            if (!url)\n                url = form || location.href;\n            const xhr = $.when($.ajax({\n                url,\n                data,\n                method: \"post\",\n                dataType: \"json\",\n            }))\n                // back-end result must contain { ok: true }, otherwise it is invalid\n                .then((dt) => {\n                if (!dt || !dt.ok) {\n                    return Promise.reject(dt);\n                }\n            });\n            asyncs.push(xhr);\n        }\n        // Async validation\n        if (asyncs.length) {\n            _state_._validating_ = $.now();\n            $elem.data(valResAttr, _state_);\n            oldVal = $elem.val();\n            let _valid = true;\n            let promise = new Promise((resolve, reject) => {\n                $.each(asyncs, (idx, x) => {\n                    x.then((dt) => {\n                        if (!_valid)\n                            return;\n                        _state_.remote = dt;\n                        if (oldVal == $elem.val()) {\n                            let rs = _state_.remotes || (_state_.remotes = {});\n                            rs[x.rule] = dt;\n                        }\n                    }, (error) => {\n                        _valid = false;\n                        _state_.remote = error;\n                        if (oldVal == $elem.val()) {\n                            _invalidate(x.rule, error);\n                        }\n                        reject(error);\n                    });\n                });\n                Promise.all(asyncs).then((all) => {\n                    if (!_valid)\n                        return;\n                    if (oldVal == $elem.val()) {\n                        _validate();\n                    }\n                    resolve(all);\n                }, $.noop); // this reject is irelevant, because we catch each individual promise\n            });\n            const _done = () => {\n                delete _state_._validating_;\n            };\n            promise.then(_done, _done);\n            return promise;\n        }\n        return _validate();\n    }\n    // ---------------------------------------------------------------------------\n    function readRules(element, rules) {\n        if (!(element instanceof $))\n            element = $(element);\n        let _rules = element.data(\"validation-rules\");\n        if (!_rules) {\n            _rules = {};\n            var type = read_pratr(element, \"type\");\n            if (element.hasClass(\"trim\"))\n                _rules[\"trim\"] = true;\n            $.each([\"email\", \"url\", \"domain\", NUMBER], function (t, r) {\n                t = read_pratr(element, r);\n                if (t == null && type == r) {\n                    t = true;\n                }\n                if (t != undefined)\n                    _rules[r] = t;\n            });\n            if (_rules.email)\n                _rules.maxlength = 320;\n            $.each([\"minlength\", \"maxlength\", \"trim\"], function (t, r) {\n                t = read_pratr(element, r);\n                if (t != undefined && -1 < (t = parseInt(t)))\n                    _rules[r] = t;\n            });\n            $.each([\n                \"minval\",\n                \"maxval\",\n                \"required\",\n                \"equalto\",\n                \"noclass\",\n                \"remote\",\n            ], function (t, r) {\n                t = read_pratr(element, r);\n                if (t != undefined)\n                    _rules[r] = t;\n            });\n            if (type == NUMBER) {\n                $.each({ min: \"minval\", max: \"maxval\" }, function (t, r) {\n                    if (!(r in _rules)) {\n                        t = read_pratr(element, t);\n                        if (t != undefined)\n                            _rules[r] = parseFloat(t);\n                    }\n                });\n            }\n            element.data(\"validation-rules\", _rules);\n        }\n        $.extend(rules || (rules = {}), _rules);\n        return rules;\n    }\n    function msg(ruleName, fieldName, options, rule, placeholder) {\n        options = _prepOptions(options);\n        const { messages } = options;\n        let message;\n        ((message = messages[fieldName]) && (message = message[ruleName])) ||\n            ((message = messages._) && (message = message[ruleName]));\n        if (message) {\n            if (!rule)\n                (rule = options.rules) && (rule = rule[fieldName]);\n            let field = placeholder || fieldName.toUCFirst();\n            let ruleValue = rule[ruleName];\n            message = message.replace(/%f%/g, `\"${field}\"`);\n            if (placeholder != undefined) {\n                message = message.replace(/%p%/g, placeholder);\n            }\n            if (ruleValue != undefined) {\n                message = message.replace(/%r%/g, ruleValue);\n            }\n        }\n        return message;\n    }\n    // ---------------------------------------------------------------------------\n    function fnValidate(rules, silent) {\n        $.validate(this, rules, function (valid, ret) {\n            if (!silent) {\n                _on_validate(this, valid, ret, rules, {});\n            }\n        });\n        return this;\n    }\n    // ---------------------------------------------------------------------------\n    function _form_refresh(evt, _init) {\n        // log('validator:form_refresh', this, evt);\n        const self = evt ? $(this) : this;\n        return $each(self, function (i, $form, d) {\n            const options = $form.data(\"validatorOpt\");\n            if (!$form.is(\":input\")) {\n                const $elements = $form.find(\"[name]:input,[data-name]:input\"), _invalids = options._invalids, elByName = {};\n                let has_inv;\n                $each($elements, function (t, $element) {\n                    const fieldName = getName($element);\n                    // disabled elements don't get validated (they are not sent to server anyways)\n                    if ($element.prop(\"disabled\")) {\n                        if (fieldName && _invalids)\n                            delete _invalids[fieldName]; // in the case it became invalid\n                        return;\n                    }\n                    if (fieldName) {\n                        elByName[fieldName] = $element[0];\n                        const rule = $.validate.readRules($element, options.rules[fieldName]);\n                        $element.data(\"_orig_val_\") != undefined ||\n                            $element.data(\"_orig_val_\", $element.val());\n                        if (rule && !$.isEmptyObject(rule)) {\n                            options.rules[fieldName] = rule;\n                            const valid = $.validate($element, rule);\n                            if (valid) {\n                                delete _invalids[fieldName];\n                            }\n                            else {\n                                has_inv = !valid;\n                                t = _invalids[fieldName] || (_invalids[fieldName] = {});\n                                t[$element.data(\"invalid\")] = $element.val();\n                            }\n                        }\n                    }\n                });\n                // unmark invalid elements that are no longer present in DOM or are disabled\n                $.each(_invalids, function (n) {\n                    if (!elByName[n]) {\n                        delete _invalids[n];\n                    }\n                });\n                // First trigger\n                options.valid = has_inv;\n                setTimeout(function () {\n                    _form_state_trigger($(d), options);\n                }, 10);\n            }\n        });\n    }\n    function _form_state_trigger(form, opt, valid) {\n        // if valid state changed\n        if (!opt)\n            opt = form.data(\"validatorOpt\");\n        if (valid == null)\n            valid = $.isEmptyObject(opt._invalids);\n        if (!opt.valid !== !valid) {\n            opt.valid = valid;\n            typeof form.prop(\"valid\") == \"object\" || form.prop(\"valid\", valid);\n            if (valid) {\n                form.removeClass(INVALID);\n                form.trigger(\"valid:form\", [opt]);\n            }\n            else {\n                form.addClass(INVALID).removeClass(VALID);\n                form.trigger(\"invalid:form\", [opt]);\n            }\n        }\n        return opt.valid;\n    }\n    function _on_validate(tgt, valid, ret, rules, params) {\n        let _evt = new $.Event(valid ? VALID : INVALID), rn = ret.invalid, $tgt = params.$tgt || $(tgt), $ctx = params.$ctx || $tgt.closest(\"form\"), name = params.name || getName($tgt), // hidden name\n        validatorOpt = params.opt || $ctx.data(\"validatorOpt\"), t;\n        $.extend(_evt, ret);\n        _evt.field = name;\n        if (validatorOpt)\n            _evt.options = validatorOpt;\n        if ((t = params.evt))\n            _evt.src_evt = t;\n        if (valid) {\n            if ((t = ret.remote && ret.remote.success)) {\n                if (typeof t == STRING) {\n                    _evt.message = t;\n                }\n            }\n            $tgt.removeClass(INVALID).addClass(VALID);\n        }\n        else {\n            if ((t = ret.remote)) {\n                _evt.message =\n                    (t && (t.msg || t.message || t.description)) || t;\n            }\n            else {\n                var placeholder = read_pratr($tgt, \"placeholder\"); // hidden placeholder\n                _evt.message = $.validate.msg(rn, name, validatorOpt, rules || ret.rules, placeholder);\n            }\n            $tgt.removeClass(VALID).addClass(INVALID);\n        }\n        let $fieldGroup;\n        if ((t = validatorOpt.fieldGroup)) {\n            $fieldGroup = $tgt.closest(t);\n            $fieldGroup\n                .removeClass(!valid ? VALID : INVALID)\n                .addClass(valid ? VALID : INVALID);\n        }\n        if ((t = validatorOpt.hintElement)) {\n            let $hintElement = $tgt.next(t);\n            if (!$hintElement.length) {\n                $hintElement = $tgt.prev(t);\n            }\n            if (!$hintElement.length) {\n                $hintElement = $tgt.siblings(t).first();\n            }\n            if (!$hintElement.length && $fieldGroup) {\n                $hintElement = $fieldGroup.find(t);\n            }\n            if ($hintElement) {\n                if (valid) {\n                    $hintElement.text(\"\").hide();\n                }\n                else {\n                    _evt.message && $hintElement.text(_evt.message).show();\n                }\n            }\n        }\n        $tgt.trigger(_evt, [_evt.message, rn]);\n        if (valid && !$tgt.is(\":focus\")) {\n            var form = $ctx.is(\":input\") ? $ctx.closest(\"form\") : $ctx, eq = form.find('[equalto=\"' + esc_quot(name) + '\"]');\n            if ((t = $tgt.attr(\"id\")))\n                eq = eq.add(form.find('[equalto=\"#' + esc_quot(name) + '\"]'));\n            eq.length && eq.trigger(\"validate\");\n        }\n        if (valid) {\n            delete validatorOpt._invalids[name];\n            if (!validatorOpt.valid) {\n                _form_state_trigger($ctx, validatorOpt);\n            }\n        }\n        else {\n            t =\n                validatorOpt._invalids[name] ||\n                    (validatorOpt._invalids[name] = {});\n            t[rn] = ret.value;\n            _form_state_trigger($ctx, validatorOpt, valid);\n        }\n    }\n    function _prepOptions(options) {\n        return $.isPlainObject(options)\n            ? $.extend(true, {}, $.validate.defaults, options)\n            : $.validate.defaults;\n    }\n    // ---------------------------------------------------------------------------\n    return $.validate;\n}\n(function (window) {\n    const $ = window && (window.jQuery || window.Zepto);\n    if ($)\n        jquery_validate($);\n})(typeof globalThis == \"undefined\"\n    ? typeof window == \"undefined\"\n        ? undefined\n        : window\n    : globalThis);\n"],"names":["read_pratr","$elem","prop","ret","attr","data","getName","_eq_r_","_is_url_r_","_is_domain_r_","_is_email_r_","esc_quot","str","String","replace","is_domain","test","is_url","is_email","$each","$list","iterator","l","length","j","constructor","i","d","context","call","STRING","NUMBER","FUNCTION","VALID","INVALID","NS","jquery_validate","$","fn","validator","fnValidator","validate","fnValidate","handler","readRules","msg","defaults","valid","undefined","hintElement","fieldGroup","validClass","invalidClass","rules","messages","_","email","url","number","required","equalto","minlength","maxlength","password","password2","extend","options","_rules","_silent","self","on","ev","join","_form_refresh","off","_prepOptions","$form","validatorOpt","_invalids","evt","$this","target","$target","name","toName","delay","to","is","type","clearTimeout","setTimeout","rule","_on_validate","$tgt","$ctx","opt","element","clb","ctx","valResAttr","oldVal","val","t","ruleName","cause","_state_","_res","_clbstk_","each","_invalidate","x","remote","removeClass","_validate","last_ret","value","_validating_","now","trim","Array","isArray","map","closest","match","find","hasClass","isNaN","parseFloat","asyncs","then","push","form","fieldName","action","field","isPlainObject","location","href","xhr","when","ajax","method","dataType","dt","ok","Promise","reject","_valid","promise","resolve","idx","rs","remotes","error","all","noop","_done","r","parseInt","min","max","placeholder","message","toUCFirst","ruleValue","silent","_init","$elements","elByName","has_inv","$element","isEmptyObject","n","_form_state_trigger","trigger","addClass","tgt","params","_evt","Event","rn","invalid","src_evt","success","description","$fieldGroup","$hintElement","next","prev","siblings","first","text","hide","show","eq","add","window","jQuery","Zepto","globalThis"],"mappings":"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"}